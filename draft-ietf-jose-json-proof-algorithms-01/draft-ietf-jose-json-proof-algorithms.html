<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>JSON Proof Algorithms</title>
<meta content="Jeremie Miller" name="author">
<meta content="Michael B. Jones" name="author">
<meta content="David Waite" name="author">
<meta content="
       The JSON Proof Algorithms (JPA) specification registers cryptographic algorithms and identifiers to be used with the JSON Web Proof and JSON Web Key (JWK) specifications. It defines several IANA registries for these identifiers. 
    " name="description">
<meta content="xml2rfc 3.18.2" name="generator">
<meta content="jose" name="keyword">
<meta content="zkp" name="keyword">
<meta content="jwp" name="keyword">
<meta content="jws" name="keyword">
<meta content="jpa" name="keyword">
<meta content="draft-ietf-jose-json-proof-algorithms-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.11.6
    ConfigArgParse 1.5.3
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 3.11.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.31.0
    setuptools 67.7.2
    six 1.16.0
    wcwidth 0.2.8
-->
<link href="draft-ietf-jose-json-proof-algorithms.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">json-proof-algorithms</td>
<td class="right">October 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Miller, et al.</td>
<td class="center">Expires 24 April 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">jose</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-jose-json-proof-algorithms-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-10-22" class="published">22 October 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-04-24">24 April 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Miller</div>
<div class="org">Ping Identity</div>
</div>
<div class="author">
      <div class="author-name">M. Jones</div>
<div class="org">individual</div>
</div>
<div class="author">
      <div class="author-name">D. Waite</div>
<div class="org">Ping Identity</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">JSON Proof Algorithms</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The JSON Proof Algorithms (JPA) specification registers cryptographic algorithms and identifiers to be used with the JSON Web Proof and JSON Web Key (JWK) specifications. It defines several IANA registries for these identifiers.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 April 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-background" class="internal xref">Background</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-algorithm-basics" class="internal xref">Algorithm Basics</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-issue" class="internal xref">Issue</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-confirm" class="internal xref">Confirm</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-present" class="internal xref">Present</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-verify" class="internal xref">Verify</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-algorithm-specifications" class="internal xref">Algorithm Specifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-single-use" class="internal xref">Single Use</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-jws-algorithm" class="internal xref">JWS Algorithm</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-holder-setup" class="internal xref">Holder Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-issuer-setup" class="internal xref">Issuer Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.4">
                    <p id="section-toc.1-1.6.2.1.2.4.1"><a href="#section-6.1.4" class="auto internal xref">6.1.4</a>.  <a href="#name-using-jws" class="internal xref">Using JWS</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.5">
                    <p id="section-toc.1-1.6.2.1.2.5.1"><a href="#section-6.1.5" class="auto internal xref">6.1.5</a>.  <a href="#name-issuer-protected-header" class="internal xref">Issuer Protected Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.6">
                    <p id="section-toc.1-1.6.2.1.2.6.1"><a href="#section-6.1.6" class="auto internal xref">6.1.6</a>.  <a href="#name-payloads" class="internal xref">Payloads</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.7">
                    <p id="section-toc.1-1.6.2.1.2.7.1"><a href="#section-6.1.7" class="auto internal xref">6.1.7</a>.  <a href="#name-presentation-protected-head" class="internal xref">Presentation Protected Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.8">
                    <p id="section-toc.1-1.6.2.1.2.8.1"><a href="#section-6.1.8" class="auto internal xref">6.1.8</a>.  <a href="#name-presentation" class="internal xref">Presentation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.9">
                    <p id="section-toc.1-1.6.2.1.2.9.1"><a href="#section-6.1.9" class="auto internal xref">6.1.9</a>.  <a href="#name-verification" class="internal xref">Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.10">
                    <p id="section-toc.1-1.6.2.1.2.10.1"><a href="#section-6.1.10" class="auto internal xref">6.1.10</a>. <a href="#name-jpa-registration" class="internal xref">JPA Registration</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.11">
                    <p id="section-toc.1-1.6.2.1.2.11.1"><a href="#section-6.1.11" class="auto internal xref">6.1.11</a>. <a href="#name-example" class="internal xref">Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-bbs" class="internal xref">BBS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-bls-curve" class="internal xref">BLS Curve</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-messages" class="internal xref">Messages</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-issuer-protected-header-2" class="internal xref">Issuer Protected Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="auto internal xref">6.2.4</a>.  <a href="#name-payloads-2" class="internal xref">Payloads</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.5">
                    <p id="section-toc.1-1.6.2.2.2.5.1"><a href="#section-6.2.5" class="auto internal xref">6.2.5</a>.  <a href="#name-issuance" class="internal xref">Issuance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.6">
                    <p id="section-toc.1-1.6.2.2.2.6.1"><a href="#section-6.2.6" class="auto internal xref">6.2.6</a>.  <a href="#name-presentation-2" class="internal xref">Presentation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.7">
                    <p id="section-toc.1-1.6.2.2.2.7.1"><a href="#section-6.2.7" class="auto internal xref">6.2.7</a>.  <a href="#name-verification-2" class="internal xref">Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.8">
                    <p id="section-toc.1-1.6.2.2.2.8.1"><a href="#section-6.2.8" class="auto internal xref">6.2.8</a>.  <a href="#name-jpa-registration-2" class="internal xref">JPA Registration</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.9">
                    <p id="section-toc.1-1.6.2.2.2.9.1"><a href="#section-6.2.9" class="auto internal xref">6.2.9</a>.  <a href="#name-example-2" class="internal xref">Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-message-authentication-code" class="internal xref">Message Authentication Code</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-holder-setup-2" class="internal xref">Holder Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="auto internal xref">6.3.2</a>.  <a href="#name-issuer-setup-2" class="internal xref">Issuer Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="auto internal xref">6.3.3</a>.  <a href="#name-issuer-protected-header-3" class="internal xref">Issuer Protected Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.4">
                    <p id="section-toc.1-1.6.2.3.2.4.1"><a href="#section-6.3.4" class="auto internal xref">6.3.4</a>.  <a href="#name-payloads-3" class="internal xref">Payloads</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.5">
                    <p id="section-toc.1-1.6.2.3.2.5.1"><a href="#section-6.3.5" class="auto internal xref">6.3.5</a>.  <a href="#name-issuer-proof" class="internal xref">Issuer Proof</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.6">
                    <p id="section-toc.1-1.6.2.3.2.6.1"><a href="#section-6.3.6" class="auto internal xref">6.3.6</a>.  <a href="#name-presentation-protected-heade" class="internal xref">Presentation Protected Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.7">
                    <p id="section-toc.1-1.6.2.3.2.7.1"><a href="#section-6.3.7" class="auto internal xref">6.3.7</a>.  <a href="#name-presentation-3" class="internal xref">Presentation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.8">
                    <p id="section-toc.1-1.6.2.3.2.8.1"><a href="#section-6.3.8" class="auto internal xref">6.3.8</a>.  <a href="#name-verifier-setup" class="internal xref">Verifier Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.9">
                    <p id="section-toc.1-1.6.2.3.2.9.1"><a href="#section-6.3.9" class="auto internal xref">6.3.9</a>.  <a href="#name-jpa-registration-3" class="internal xref">JPA Registration</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.10">
                    <p id="section-toc.1-1.6.2.3.2.10.1"><a href="#section-6.3.10" class="auto internal xref">6.3.10</a>. <a href="#name-example-3" class="internal xref">Example</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-jwp-algorithms-registry" class="internal xref">JWP Algorithms Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The JSON Web Proof (JWP) <span>[<a href="#I-D.ietf-jose-json-web-proof" class="cite xref">I-D.ietf-jose-json-web-proof</a>]</span> draft establishes a new secure container format that supports selective disclosure and unlinkability using Zero-Knowledge Proofs (ZKPs) or other cryptographic algorithms.<a href="#section-1-1" class="pilcrow">¶</a></p>
<blockquote id="section-1-2">
        <p id="section-1-2.1">Editor's Note: This draft is still early and incomplete, there will be significant changes to the algorithms as currently defined here.  Please do not use any of these definitions or examples for anything except personal experimentation and learning.  Contributions and feedback are welcome at <a href="https://github.com/json-web-proofs/json-web-proofs">https://github.com/json-web-proofs/json-web-proofs</a>.<a href="#section-1-2.1" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The roles of "issuer", "holder", and "verifier" are used as defined by the <a href="https://www.w3.org/TR/2021/REC-vc-data-model-20211109/">Verifiable Credentials Data Model v1.1</a>.  The term "presentation" is also used as defined by this source, but the term "credential" is avoided in this specification in order to minimize confusion with other definitions.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">The terms "JSON Web Signature (JWS)", "Base64url Encoding", "Header Parameter", "JOSE Header", "JWS Payload", "JWS Signature", and "JWS Protected Header" are defined by <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The terms "JSON Web Proof (JWP)", "JWP Payload", "JWP Proof", and "JWP Protected Header" are defined by the JWP draft.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">These terms are defined by this specification:<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Stable Key
  An asymmetric key-pair used by an issuer that is also shared via an out-of-band mechanism to a verifier in order to validate the signature.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Ephemeral Key
  An asymmetric key-pair that is generated for one-time use by an issuer and never stored or used again outside of the creation of a single JWP.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Presentation Key
  An asymmetric key-pair that is generated by a holder and used to ensure that a presentation is not able to be replayed by any other party.<a href="#section-3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="background">
<section id="section-4">
      <h2 id="name-background">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<p id="section-4-1">JWP defines a container binding together a protected header, one or more payloads, and a cryptographic proof.  It does not define any details about the interactions between an application and the cryptographic libraries that implement proof-supporting algorithms.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Due to the nature of ZKPs, this specification also documents the subtle but important differences in proof algorithms versus those defined by the JSON Web Algorithms <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span>.  These differences help support more advanced capabilities such as blinded signatures and predicate proofs.<a href="#section-4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="algorithm-basics">
<section id="section-5">
      <h2 id="name-algorithm-basics">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-algorithm-basics" class="section-name selfRef">Algorithm Basics</a>
      </h2>
<p id="section-5-1">The four principal interactions that every proof algorithm MUST support are <code>[issue](#issue)</code>, <code>[confirm](#confirm)</code>, <code>[present](#present)</code>, and <code>[verify](#verify)</code>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="issue">
<section id="section-5.1">
        <h3 id="name-issue">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-issue" class="section-name selfRef">Issue</a>
        </h3>
<p id="section-5.1-1">The JWP is first created as the output of a JPA's <code>issue</code> operation.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Every algorithm MUST support a JSON issuer protected header along with one or more octet string payloads.  The algorithm MAY support using additional items provided by the holder for issuance such as blinded payloads, keys for replay prevention, etc.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">All algorithms MUST provide integrity protection for the issuer header and all payloads and MUST specify all digest and/or hash2curve methods used.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="confirm">
<section id="section-5.2">
        <h3 id="name-confirm">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-confirm" class="section-name selfRef">Confirm</a>
        </h3>
<p id="section-5.2-1">Performed by the holder to validate the issued JWP is correctly formed and protected.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Each algorithm MAY support using additional input items options such as those sent to the issuer for issuance. After confirmation, an algorithm MAY return a modified JWP for serialized storage without the local state (such as with blinded payloads now unblinded).<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">The algorithm MUST fully verify the issued proof value against the issuer protected header and all payloads.  If given a presented JWP instead of an issued one the confirm process MUST return an error.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="present">
<section id="section-5.3">
        <h3 id="name-present">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-present" class="section-name selfRef">Present</a>
        </h3>
<p id="section-5.3-1">Used to apply any selective disclosure choices and perform any unlinkability transformations.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">An algorithm MAY support additional input options from the requesting party such as for predicate proofs and verifiable computation requests.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">Every algorithm MUST support the ability to hide any or all payloads.  It MUST always include the issuer protected header unmodified in the presentation.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">The algorithm MUST replace the issued proof value and generate a new presented proof value.  It also MUST include a new presentation protected header that provides replay protection.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify">
<section id="section-5.4">
        <h3 id="name-verify">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-verify" class="section-name selfRef">Verify</a>
        </h3>
<p id="section-5.4-1">Performed by the verifier to verify the protected headers along with any disclosed payloads and/or assertions about them from the proving party, while also verifying they are the same payloads and ordering as witnessed by the issuer.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">The algorithm MUST verify the integrity of all disclosed payloads and MUST also verify the integrity of both the issuer and presentation protected headers.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">If the presented proof contains any assertions about the hidden payloads, the algorithm MUST also verify all of those assertions.
It MAY support additional options such as those sent to the holder to generate the presentation.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">If given an issued JWP for verification, the algorithm MUST return an error.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="algorithm-specifications">
<section id="section-6">
      <h2 id="name-algorithm-specifications">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-algorithm-specifications" class="section-name selfRef">Algorithm Specifications</a>
      </h2>
<p id="section-6-1">This section defines how to use specific algorithms for JWPs.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="single-use">
<section id="section-6.1">
        <h3 id="name-single-use">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-single-use" class="section-name selfRef">Single Use</a>
        </h3>
<blockquote id="section-6.1-1">
          <p id="section-6.1-1.1">Editor's Note: This algorithm is going to be renamed and slightly refactored; the new name is still TBD.<a href="#section-6.1-1.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-6.1-2">The Single Use (SU) algorithm is based on composing multiple traditional JWS values into a single JWP proof value.  It enables a very simple form of selective disclosure without requiring any advanced cryptographic techniques.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">It does not support unlinkability if the same JWP is presented multiple times, therefore when privacy is required the holder will need to interact with the issuer again to receive new single-use JWPs (dynamically or in batches).<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<div id="jws-algorithm">
<section id="section-6.1.1">
          <h4 id="name-jws-algorithm">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-jws-algorithm" class="section-name selfRef">JWS Algorithm</a>
          </h4>
<p id="section-6.1.1-1">The Single Use algorithm is based on using multiple JWS values, all of which are generated with the same JSON Web Algorithm (JWA) for signing.  This JWA identifier is included as part of the Single Use identifier for JWP.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">The chosen JWA MUST be an asymmetric signing algorithm so that each signature can be verified without sharing any private values between the parties.  This ensures that the verifier cannot brute force any non-disclosed payloads based only on their disclosed individual signatures.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="holder-setup">
<section id="section-6.1.2">
          <h4 id="name-holder-setup">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-holder-setup" class="section-name selfRef">Holder Setup</a>
          </h4>
<p id="section-6.1.2-1">In order to support the protection of a presentation by a holder to a verifier, the holder MUST use a Presentation Key during the issuance and the presentation of every Single Use JWP.  This Presentation Key MUST be generated and used for only one JWP.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">The issuer MUST verify that the holder has possession of this key.  The holder-issuer communication to exchange this information is out of scope of this specification but can be easily accomplished by the holder using this key to generate a JWS that signs a value the issuer can verify as unique.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-setup">
<section id="section-6.1.3">
          <h4 id="name-issuer-setup">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-issuer-setup" class="section-name selfRef">Issuer Setup</a>
          </h4>
<p id="section-6.1.3-1">To create a Single Use JWP the issuer first generates a unique Ephemeral Key using the selected JWS algorithm.  This key-pair will be used to sign each of the payloads of a single JWP and then discarded.<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="using-jws">
<section id="section-6.1.4">
          <h4 id="name-using-jws">
<a href="#section-6.1.4" class="section-number selfRef">6.1.4. </a><a href="#name-using-jws" class="section-name selfRef">Using JWS</a>
          </h4>
<p id="section-6.1.4-1">JSON Web Signatures are used to create all of the signature values used by the SU algorithm.  This allows an implementation to use an existing JWS library directly for all necessary cryptographic operations without requiring any additional primitives.<a href="#section-6.1.4-1" class="pilcrow">¶</a></p>
<p id="section-6.1.4-2">Each individual JWS uses a fixed protected header containing only the minimum required <code>alg</code> value.  Since this JWS protected header itself is the same for every JWS, it SHOULD be a static value in the form of <code>{"alg":"***"}</code> where <code>***</code> is the JWA asymmetric signing key algorithm identifier being used.  This value is recreated by a verifier using the correct JWA algorithm value included in the SU algorithm identifier.<a href="#section-6.1.4-2" class="pilcrow">¶</a></p>
<p id="section-6.1.4-3">If an implementation uses an alternative JWS protected header than this fixed value, a base64url encoded serialized form of the alternate fixed header MUST be included using the <code>jws_header</code> claim in the issuer protected header.<a href="#section-6.1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-protected-header">
<section id="section-6.1.5">
          <h4 id="name-issuer-protected-header">
<a href="#section-6.1.5" class="section-number selfRef">6.1.5. </a><a href="#name-issuer-protected-header" class="section-name selfRef">Issuer Protected Header</a>
          </h4>
<p id="section-6.1.5-1">The JWK of the issuer's Ephemeral Key MUST be included in the issuer protected header with the property name of <code>proof_jwk</code> and contain only the REQUIRED values to represent the public key.<a href="#section-6.1.5-1" class="pilcrow">¶</a></p>
<p id="section-6.1.5-2">The holder's Presentation Key JWK MUST be included in issuer protected header using the <code>presentation_jwk</code> claim.<a href="#section-6.1.5-2" class="pilcrow">¶</a></p>
<p id="section-6.1.5-3">The final issuer protected header is then used directly as the body of a JWS and signed using the issuer's Stable Key.  The resulting JWS signature value unencoded octet string is the first value in the JWP proof.<a href="#section-6.1.5-3" class="pilcrow">¶</a></p>
<p id="section-6.1.5-4">In various examples in this specification the octet string serialized issuer header is referenced as <code>issuer_header</code>.<a href="#section-6.1.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payloads">
<section id="section-6.1.6">
          <h4 id="name-payloads">
<a href="#section-6.1.6" class="section-number selfRef">6.1.6. </a><a href="#name-payloads" class="section-name selfRef">Payloads</a>
          </h4>
<p id="section-6.1.6-1">Each JWP payload is processed in order and signed as a JWS body using the issuer's Ephemeral Key.  The resulting JWS signature value unencoded octet string is appended to the JWP proof.<a href="#section-6.1.6-1" class="pilcrow">¶</a></p>
<p id="section-6.1.6-2">The proof value as an octet string will have a total length that is the sum of the fixed length of the issuer protected header signature plus the fixed length of each of the payload Ephemeral Key signatures.  For example, the signature for the ES256 algorithm is 64 octets and for a JWP with five payloads the total proof value length would be <code>64 * (1 + 5) = 384</code> octets).<a href="#section-6.1.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-protected-header">
<section id="section-6.1.7">
          <h4 id="name-presentation-protected-head">
<a href="#section-6.1.7" class="section-number selfRef">6.1.7. </a><a href="#name-presentation-protected-head" class="section-name selfRef">Presentation Protected Header</a>
          </h4>
<p id="section-6.1.7-1">In order to generate a new presentation, the holder first creates a presentation protected header that is specific to the verifier being presented to.  This header MUST contain a claim that both the holder and verifier trust as being unique and non-replayable.<a href="#section-6.1.7-1" class="pilcrow">¶</a></p>
<p id="section-6.1.7-2">This specification registers a <code>nonce</code> claim for the presentation protected header that contains a string value either generated by the verifier or derived from values provided by the verifier.  When present, the verifier MUST ensure the nonce value matches during verification.<a href="#section-6.1.7-2" class="pilcrow">¶</a></p>
<p id="section-6.1.7-3">The presentation protected header MAY contain other claims that are either provided by the verifier or by the holder.  These presentation claims SHOULD NOT contain values that are common across multiple presentations and SHOULD be unique to a single presentation and verifier.<a href="#section-6.1.7-3" class="pilcrow">¶</a></p>
<p id="section-6.1.7-4">In various examples in this specification the octet string serialized presentation header is referenced as <code>presentation_header</code>.<a href="#section-6.1.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation">
<section id="section-6.1.8">
          <h4 id="name-presentation">
<a href="#section-6.1.8" class="section-number selfRef">6.1.8. </a><a href="#name-presentation" class="section-name selfRef">Presentation</a>
          </h4>
<blockquote id="section-6.1.8-1">
            <p id="section-6.1.8-1.1">Editor's Note: The current definition here is incomplete, the holder's signature needs to also incorporate the presented proof.<a href="#section-6.1.8-1.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-6.1.8-2">The holder derives a new proof value when presenting it to a verifier.  The presented proof value will always contain the issuer's Stable Key signature for the issuer protected header as the first element.<a href="#section-6.1.8-2" class="pilcrow">¶</a></p>
<p id="section-6.1.8-3">The second element of the presented proof value is always the holder's Presentation Key signature of the presentation protected header, constructed identically to the issuer protected header by using the serialized JSON value octet string as the JWS body.  Signing only the presentation header with the Presentation Key is sufficient to protect the entire presentation since that key is private to the holder and only the contents of the presentation header are used for replay prevention.<a href="#section-6.1.8-3" class="pilcrow">¶</a></p>
<p id="section-6.1.8-4">The two header signatures are then followed by only the issuer's Ephemeral Key signatures for each payload that is disclosed.  The order of the payload signatures is preserved and MUST be in the same order as the included disclosed payloads in the presented JWP.  Non-disclosed payloads will NOT have a signature value included.  For example, if the second and fifth payloads are hidden then the holder's derived proof value would be of the length <code>64 * (1 + 1 + the 1st, 2nd, and 4th payload signatures) = 320 octets</code>.<a href="#section-6.1.8-4" class="pilcrow">¶</a></p>
<p id="section-6.1.8-5">Since the individual signatures in the proof value are unique and remain unchanged across multiple presentations, a Single Use JWP SHOULD only be presented a single time to each verifier in order for the holder to remain unlinkable across multiple presentations.<a href="#section-6.1.8-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verification">
<section id="section-6.1.9">
          <h4 id="name-verification">
<a href="#section-6.1.9" class="section-number selfRef">6.1.9. </a><a href="#name-verification" class="section-name selfRef">Verification</a>
          </h4>
<p id="section-6.1.9-1">The verifier MUST verify the issuer protected header against the first matching JWS signature part in the proof value using the issuer's Stable Key.  It MUST also verify the presentation protected header against the second JWS signature part in the proof value using the holder's Presentation Key as provided in the <code>presentation_jwk</code> claim in the issuer protected header.<a href="#section-6.1.9-1" class="pilcrow">¶</a></p>
<p id="section-6.1.9-2">With the headers verified, the issuer's Ephemeral Key as given in the issuer protected header <code>proof_jwk</code> claim can then be used to verify each of the disclosed payload signatures.<a href="#section-6.1.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jpa-registration">
<section id="section-6.1.10">
          <h4 id="name-jpa-registration">
<a href="#section-6.1.10" class="section-number selfRef">6.1.10. </a><a href="#name-jpa-registration" class="section-name selfRef">JPA Registration</a>
          </h4>
<p id="section-6.1.10-1">Proposed JWP <code>alg</code> value is of the format "SU-" appended with the relevant JWS <code>alg</code> value for the chosen public and ephemeral key-pair algorithm, for example "SU-ES256".<a href="#section-6.1.10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example">
<section id="section-6.1.11">
          <h4 id="name-example">
<a href="#section-6.1.11" class="section-number selfRef">6.1.11. </a><a href="#name-example" class="section-name selfRef">Example</a>
          </h4>
<p id="section-6.1.11-1">See the example in the appendix of the JSON Web Proof draft.<a href="#section-6.1.11-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bbs">
<section id="section-6.2">
        <h3 id="name-bbs">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-bbs" class="section-name selfRef">BBS</a>
        </h3>
<p id="section-6.2-1">The BBS Signature Scheme <span>[<a href="#I-D.irtf-cfrg-bbs-signatures" class="cite xref">I-D.irtf-cfrg-bbs-signatures</a>]</span> is under active development within the CRFG. Prior to this effort work was done under the DIF <a href="https://identity.foundation/working-groups/crypto.html">Applied Cryptography Working Group</a>, an effort to clarify and bring best practices to early prototypes leveraged by multiple early stage decentralized identity projects.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">This JSON Proof Algorithm definition for BBS is based on the already released implementation and relies on the provided software API.  A future definition with a different <code>alg</code> value will be created to succeed this version as the BBS standardization effort progresses.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">This algorithm supports both selective disclosure and unlinkability, enabling the holder to generate multiple presentations from one issued JWP without any verifier being able to correlate those presentations together.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div id="bls-curve">
<section id="section-6.2.1">
          <h4 id="name-bls-curve">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-bls-curve" class="section-name selfRef">BLS Curve</a>
          </h4>
<p id="section-6.2.1-1">The pairing friendly elliptic curve used for the BBS software implementation is part of the BLS family with an embedding degree of 12 over a 381-bit prime field.  For this JPA, only the group G2 is used.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">In the implementation the method used to generate the key pairs is <code>generateBls12381G2KeyPair()</code>.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="messages">
<section id="section-6.2.2">
          <h4 id="name-messages">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-messages" class="section-name selfRef">Messages</a>
          </h4>
<p id="section-6.2.2-1">BBS is a multi-message scheme and operates on an array of individual messages for signing and proof generation.  Each message is a single binary octet string.  The BBS implementation uses a hash-to-curve method to map each message to a point.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-protected-header-1">
<section id="section-6.2.3">
          <h4 id="name-issuer-protected-header-2">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-issuer-protected-header-2" class="section-name selfRef">Issuer Protected Header</a>
          </h4>
<p id="section-6.2.3-1">The UTF-8 octet string of the issuer protected header is the first message in the input array at index 0.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payloads-1">
<section id="section-6.2.4">
          <h4 id="name-payloads-2">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-payloads-2" class="section-name selfRef">Payloads</a>
          </h4>
<p id="section-6.2.4-1">The octet strings of each payload are placed into the BBS message array following the issuer protected header message.  For example, the first payload is at index 1 of the array and the last payload is always the last message in the array.<a href="#section-6.2.4-1" class="pilcrow">¶</a></p>
<p id="section-6.2.4-2">In future versions of this algorithm, there will be additional methods defined for transforming a payload into a point such that additional Zero-Knowledge Proof types can be supported by the holder such as range and membership predicates.<a href="#section-6.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance">
<section id="section-6.2.5">
          <h4 id="name-issuance">
<a href="#section-6.2.5" class="section-number selfRef">6.2.5. </a><a href="#name-issuance" class="section-name selfRef">Issuance</a>
          </h4>
<p id="section-6.2.5-1">The issuer's BLS12-381 G2 Stable Key is used to sign the completed message array input containing the octet strings of the issuer protected header and every payload.  The result is a signature octet string that is used as the initial JWP proof value.<a href="#section-6.2.5-1" class="pilcrow">¶</a></p>
<p id="section-6.2.5-2">In the implementation, the method used to perform the signing is <code>blsSign({keyPair, [header, payload1, payload2, ...]})</code> and returns a binary signature value.<a href="#section-6.2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-1">
<section id="section-6.2.6">
          <h4 id="name-presentation-2">
<a href="#section-6.2.6" class="section-number selfRef">6.2.6. </a><a href="#name-presentation-2" class="section-name selfRef">Presentation</a>
          </h4>
<p id="section-6.2.6-1">The holder must decode the issuer protected header and payload values in order to generate the identical message array that the issuer used.<a href="#section-6.2.6-1" class="pilcrow">¶</a></p>
<p id="section-6.2.6-2">To generate a presented JWP for a verifier, the holder must use a cryptographic nonce that is provided by that verifier as input.  This nonce MUST be a 32-byte octet string that the verifier generated by a secure RNG.  How this nonce value is communicated to the holder is out of scope of this presentation.  The <code>nonce</code> claim in the presentation protected header is used to store the verifier's given nonce value.<a href="#section-6.2.6-2" class="pilcrow">¶</a></p>
<p id="section-6.2.6-3">The holder also applies selective disclosure preferences by creating an array of indices of which messages in the input array are to be revealed to the verifier.  The revealed indices MUST include the value <code>0</code> so that the issuer protected header message is always revealed to the verifier.<a href="#section-6.2.6-3" class="pilcrow">¶</a></p>
<p id="section-6.2.6-4">The result of creating a proof is an octet string that is used as the presented JWP proof value.<a href="#section-6.2.6-4" class="pilcrow">¶</a></p>
<p id="section-6.2.6-5">In the implementation, the method used to generate the proof is <code>blsCreateProof({signedProof, publicKey, [issuer_header, payload1, payload2, ...], presentation_header, [0, 2, ...])</code>.<a href="#section-6.2.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verification-1">
<section id="section-6.2.7">
          <h4 id="name-verification-2">
<a href="#section-6.2.7" class="section-number selfRef">6.2.7. </a><a href="#name-verification-2" class="section-name selfRef">Verification</a>
          </h4>
<p id="section-6.2.7-1">The verifier decodes the JWP issuer protected header and payload values into a messages array, skipping any non-revealed payloads.  The current BBS implementation embeds the revealed indices into the output proof value, so the verification messages array only needs to include the disclosed messages.<a href="#section-6.2.7-1" class="pilcrow">¶</a></p>
<p id="section-6.2.7-2">In the implementation, the method used to verify the proof is <code>blsVerifyProof({verifyProof, publicKey, [issuer_header, payload2, ...], presentation_header)</code>.<a href="#section-6.2.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jpa-registration-1">
<section id="section-6.2.8">
          <h4 id="name-jpa-registration-2">
<a href="#section-6.2.8" class="section-number selfRef">6.2.8. </a><a href="#name-jpa-registration-2" class="section-name selfRef">JPA Registration</a>
          </h4>
<p id="section-6.2.8-1">Proposed JWP <code>alg</code> value for BBS based on the software implementation is "BBS-X".<a href="#section-6.2.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-1">
<section id="section-6.2.9">
          <h4 id="name-example-2">
<a href="#section-6.2.9" class="section-number selfRef">6.2.9. </a><a href="#name-example-2" class="section-name selfRef">Example</a>
          </h4>
<p id="section-6.2.9-1">The following example uses the given BLS12-384 key-pair:<a href="#section-6.2.9-1" class="pilcrow">¶</a></p>
<p id="section-6.2.9-2">Public:<a href="#section-6.2.9-2" class="pilcrow">¶</a></p>
<span id="name-bbs-issuer-public-octets"></span><figure id="figure-1">
            <div class="lang-json sourcecode" id="section-6.2.9-3.1">
<pre>[179, 209, 122, 60, 230, 37, 188, 86, 19, 19, 4, 36, 240, 230, 79,
178, 230, 147, 9, 60, 239, 41, 233, 167, 190, 252, 154, 35, 39, 201,
238, 73, 77, 228, 20, 47, 109, 174, 15, 168, 187, 145, 126, 85, 83,
151, 48, 30, 13, 237, 92, 179, 124, 181, 211, 204, 187, 222, 229,
234, 182, 94, 60, 157, 19, 148, 162, 48, 185, 134, 177, 168, 68,
115, 167, 48, 92, 181, 168, 53, 52, 246, 201, 112, 103, 23, 159,
138, 225, 13, 165, 171, 251, 112, 163, 96]
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-bbs-issuer-public-octets" class="selfRef">bbs-issuer-public-octets</a>
            </figcaption></figure>
<p id="section-6.2.9-4">Private:<a href="#section-6.2.9-4" class="pilcrow">¶</a></p>
<span id="name-bbs-issuer-private-octets"></span><figure id="figure-2">
            <div class="lang-json sourcecode" id="section-6.2.9-5.1">
<pre>[72, 125, 227, 97, 150, 148, 186, 145, 110, 46, 135, 232, 104, 204,
128, 242, 73, 151, 72, 162, 0, 54, 139, 146, 221, 137, 34, 74, 1,
42, 140, 206]
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-bbs-issuer-private-octets" class="selfRef">bbs-issuer-private-octets</a>
            </figcaption></figure>
<p id="section-6.2.9-6">The protected header used is:<a href="#section-6.2.9-6" class="pilcrow">¶</a></p>
<span id="name-bbs-issuer-protected-header"></span><figure id="figure-3">
            <div class="lang-json sourcecode" id="section-6.2.9-7.1">
<pre>{
  "iss": "https://issuer.example",
  "claims": [
    "family_name",
    "given_name",
    "email",
    "age"
  ],
  "typ": "JPT",
  "alg": "BBS-X"
}
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-bbs-issuer-protected-header" class="selfRef">bbs-issuer-protected-header</a>
            </figcaption></figure>
<p id="section-6.2.9-8">The first payload is the string <code>"Doe"</code> with the octet sequence of <code>[ 34, 68, 111, 101, 34 ]</code> and base64url-encoded as <code>IkRvZSI</code>.<a href="#section-6.2.9-8" class="pilcrow">¶</a></p>
<p id="section-6.2.9-9">The second payload is the string <code>"Jay"</code> with the octet sequence of <code>[ 34, 74, 97, 121, 34 ]</code> and base64url-encoded as <code>IkpheSI</code>.<a href="#section-6.2.9-9" class="pilcrow">¶</a></p>
<p id="section-6.2.9-10">The third payload is the string <code>"jaydoe@example.org"</code> with the octet sequence of <code>[ 34, 106, 97, 121, 100, 111, 101, 64, 101, 120, 97, 109, 112, 108, 101, 46, 111, 114, 103, 34 ]</code> and base64url-encoded as <code>ImpheWRvZUBleGFtcGxlLm9yZyI</code>.<a href="#section-6.2.9-10" class="pilcrow">¶</a></p>
<p id="section-6.2.9-11">The fourth payload is the string <code>42</code> with the octet sequence of <code>[ 52, 50 ]</code> and base64url-encoded as <code>NDI</code>.<a href="#section-6.2.9-11" class="pilcrow">¶</a></p>
<p id="section-6.2.9-12">The message array used as an input to the BLS implementation is:<a href="#section-6.2.9-12" class="pilcrow">¶</a></p>
<span id="name-bbs-issuer-messages"></span><figure id="figure-4">
            <div class="lang-json sourcecode" id="section-6.2.9-13.1">
<pre>[
 [123, 34, 105, 115, 115, 34, 58, 34, 104, 116, 116, 112, 115, 58,
  47, 47, 105, 115, 115, 117, 101, 114, 46, 101, 120, 97, 109, 112,
  108, 101, 34, 44, 34, 99, 108, 97, 105, 109, 115, 34, 58, 91, 34,
  102, 97, 109, 105, 108, 121, 95, 110, 97, 109, 101, 34, 44, 34,
  103, 105, 118, 101, 110, 95, 110, 97, 109, 101, 34, 44, 34, 101,
  109, 97, 105, 108, 34, 44, 34, 97, 103, 101, 34, 93, 44, 34, 116,
  121, 112, 34, 58, 34, 74, 80, 84, 34, 44, 34, 97, 108, 103, 34, 58,
  34, 66, 66, 83, 45, 88, 34, 125],
 [ 34, 68, 111, 101, 34 ],
 [ 34, 74, 97, 121, 34 ],
 [34, 106, 97, 121, 100, 111, 101, 64, 101, 120, 97, 109, 112, 108,
 101, 46, 111, 114, 103, 34], [ 52, 50 ]
]
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-bbs-issuer-messages" class="selfRef">bbs-issuer-messages</a>
            </figcaption></figure>
<p id="section-6.2.9-14">Using the above inputs, the output of the <code>blsSign()</code> call is the octet string:<a href="#section-6.2.9-14" class="pilcrow">¶</a></p>
<span id="name-bbs-issuer-signature"></span><figure id="figure-5">
            <div class="lang-json sourcecode" id="section-6.2.9-15.1">
<pre>[180, 3, 66, 254, 9, 205, 20, 88, 175, 82, 90, 34, 26, 178, 80, 225,
91, 209, 120, 23, 185, 159, 76, 73, 189, 236, 115, 141, 31, 83, 43,
42, 186, 247, 196, 236, 70, 19, 123, 80, 249, 146, 237, 172, 48,
208, 193, 62, 100, 59, 154, 22, 52, 165, 184, 250, 71, 52, 106, 233,
26, 240, 251, 214, 122, 133, 61, 241, 70, 127, 83, 240, 112, 130,
181, 151, 160, 214, 43, 213, 83, 211, 238, 191, 1, 65, 135, 147,
226, 197, 24, 104, 183, 9, 141, 207, 21, 106, 136, 161, 115, 142, 3,
196, 155, 52, 174, 205, 212, 13, 174, 220]
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-bbs-issuer-signature" class="selfRef">bbs-issuer-signature</a>
            </figcaption></figure>
<p id="section-6.2.9-16">The resulting signed JWP in JSON serialization is:<a href="#section-6.2.9-16" class="pilcrow">¶</a></p>
<span id="name-bbs-issued-jwp"></span><figure id="figure-6">
            <div class="lang-json sourcecode" id="section-6.2.9-17.1">
<pre>{
  "protected": "eyJpc3MiOiJodHRwczovL2lzc3Vlci5leGFtcGxlIiwiY2xhaW1z
  IjpbImZhbWlseV9uYW1lIiwiZ2l2ZW5fbmFtZSIsImVtYWlsIiwiYWdlIl0sInR5cC
  I6IkpQVCIsImFsZyI6IkJCUy1YIn0",
  "payloads": [
    "IkRvZSI",
    "IkpheSI",
    "ImpheWRvZUBleGFtcGxlLm9yZyI",
    "NDI"
  ],
  "proof": "tANC_gnNFFivUloiGrJQ4VvReBe5n0xJvexzjR9TKyq698TsRhN7UPmS
  7aww0ME-ZDuaFjSluPpHNGrpGvD71nqFPfFGf1PwcIK1l6DWK9VT0-6_AUGHk-LFGG
  i3CY3PFWqIoXOOA8SbNK7N1A2u3A"
}
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-bbs-issued-jwp" class="selfRef">bbs-issued-jwp</a>
            </figcaption></figure>
<p id="section-6.2.9-18">The same JWP in compact serialization:<a href="#section-6.2.9-18" class="pilcrow">¶</a></p>
<span id="name-bbs-issued-compact"></span><figure id="figure-7">
            <div class="lang-text sourcecode" id="section-6.2.9-19.1">
<pre>ImV5SnBjM01pT2lKb2RIUndjem92TDJsemMzVmxjaTVsZUdGdGNHeGxJaXdpWTJ4aGFX
MXpJanBiSW1aaGJXbHNlVjl1WVcxbElpd2laMmwyWlc1ZmJtRnRaU0lzSW1WdFlXbHNJ
aXdpWVdkbElsMHNJblI1Y0NJNklrcFFWQ0lzSW1Gc1p5STZJa0pDVXkxWUluMCI.IkRv
ZSI~IkpheSI~ImpheWRvZUBleGFtcGxlLm9yZyI~NDI.tANC_gnNFFivUloiGrJQ4VvR
eBe5n0xJvexzjR9TKyq698TsRhN7UPmS7aww0ME-ZDuaFjSluPpHNGrpGvD71nqFPfFG
f1PwcIK1l6DWK9VT0-6_AUGHk-LFGGi3CY3PFWqIoXOOA8SbNK7N1A2u3A
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-bbs-issued-compact" class="selfRef">bbs-issued-compact</a>
            </figcaption></figure>
<p id="section-6.2.9-20">For verification, a nonce is needed:<a href="#section-6.2.9-20" class="pilcrow">¶</a></p>
<span id="name-bbs-present-nonce"></span><figure id="figure-8">
            <div class="lang-json sourcecode" id="section-6.2.9-21.1">
<pre>[137, 103, 248, 147, 211, 133, 97, 190, 130, 157, 110, 64, 244, 250,
100, 151, 7, 36, 164, 109, 146, 195, 190, 75, 32, 255, 6, 128, 44,
128, 96, 9]
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-bbs-present-nonce" class="selfRef">bbs-present-nonce</a>
            </figcaption></figure>
<p id="section-6.2.9-22">To generate a proof, the <code>blsCreateProof()</code> method is used with a revealed indexes array argument of <code>[ 0, 2, 4 ]</code> and results in the octet string:<a href="#section-6.2.9-22" class="pilcrow">¶</a></p>
<span id="name-bbs-present-proof"></span><figure id="figure-9">
            <div class="lang-json sourcecode" id="section-6.2.9-23.1">
<pre>[0, 5, 21, 169, 73, 242, 49, 111, 234, 26, 186, 194, 204, 174, 241,
30, 165, 50, 117, 236, 144, 95, 147, 186, 219, 190, 135, 205, 66,
179, 227, 86, 151, 246, 174, 234, 204, 46, 171, 249, 225, 198, 135,
81, 131, 225, 141, 217, 47, 217, 127, 176, 15, 98, 110, 233, 74,
220, 230, 27, 201, 117, 114, 211, 41, 183, 44, 64, 185, 45, 140,
153, 49, 73, 199, 93, 208, 248, 212, 175, 106, 199, 83, 255, 128,
77, 152, 250, 166, 101, 78, 248, 10, 106, 236, 24, 238, 21, 34, 134,
128, 186, 132, 153, 123, 86, 88, 156, 246, 203, 23, 253, 248, 217,
233, 1, 168, 208, 12, 193, 222, 142, 90, 28, 223, 241, 130, 164,
144, 83, 0, 15, 165, 25, 156, 145, 243, 39, 88, 249, 246, 185, 152,
3, 220, 72, 180, 0, 0, 0, 116, 133, 180, 58, 53, 105, 120, 124, 227,
160, 78, 229, 74, 209, 111, 164, 101, 183, 86, 122, 212, 126, 90,
23, 228, 109, 184, 73, 75, 114, 177, 142, 178, 89, 107, 100, 189,
187, 74, 143, 167, 218, 186, 193, 189, 247, 14, 134, 40, 0, 0, 0, 2,
5, 130, 120, 86, 255, 28, 33, 145, 20, 149, 195, 8, 4, 200, 212,
178, 67, 147, 230, 174, 192, 9, 158, 94, 179, 144, 63, 60, 82, 255,
216, 4, 85, 108, 209, 194, 209, 177, 106, 69, 215, 235, 177, 83,
244, 1, 195, 102, 135, 99, 20, 121, 7, 252, 26, 187, 206, 16, 250,
134, 1, 255, 197, 92, 130, 105, 241, 175, 35, 22, 210, 101, 158,
113, 214, 222, 3, 4, 168, 188, 251, 34, 213, 211, 224, 150, 147, 38,
164, 229, 151, 226, 223, 188, 181, 180, 204, 228, 58, 107, 55, 232,
148, 180, 199, 42, 181, 127, 59, 233, 234, 188, 0, 0, 0, 4, 93, 196,
31, 38, 151, 105, 231, 46, 228, 46, 86, 196, 136, 212, 175, 170, 83,
21, 78, 19, 224, 211, 122, 7, 92, 71, 17, 171, 66, 122, 56, 130, 45,
19, 172, 217, 65, 63, 246, 39, 6, 30, 77, 132, 86, 36, 41, 3, 234,
72, 146, 200, 101, 150, 159, 108, 140, 15, 195, 57, 249, 154, 191,
204, 91, 30, 159, 32, 157, 24, 3, 110, 90, 102, 99, 206, 42, 58, 1,
181, 215, 85, 29, 32, 131, 46, 76, 25, 5, 43, 203, 32, 215, 167,
169, 108, 56, 174, 146, 51, 174, 40, 190, 22, 37, 93, 156, 245,
208, 26, 55, 180, 135, 115, 70, 96, 106, 243, 213, 131, 196, 63,
165, 42, 157, 22, 94, 46]
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-bbs-present-proof" class="selfRef">bbs-present-proof</a>
            </figcaption></figure>
<p id="section-6.2.9-24">The resulting verifiable JWP in JSON serialization is:<a href="#section-6.2.9-24" class="pilcrow">¶</a></p>
<span id="name-bbs-present-jwp"></span><figure id="figure-10">
            <div class="lang-json sourcecode" id="section-6.2.9-25.1">
<pre>{
  "protected": "eyJpc3MiOiJodHRwczovL2lzc3Vlci5leGFtcGxlIiwiY2xhaW1z
  IjpbImZhbWlseV9uYW1lIiwiZ2l2ZW5fbmFtZSIsImVtYWlsIiwiYWdlIl0sInR5cC
  I6IkpQVCIsImFsZyI6IkJCUy1YIn0",
  "payloads": [
    null,
    "IkpheSI",
    null,
    "NDI"
  ],
  "proof": "AAUVqUnyMW_qGrrCzK7xHqUydeyQX5O6276HzUKz41aX9q7qzC6r-eHG
  h1GD4Y3ZL9l_sA9ibulK3OYbyXVy0ym3LEC5LYyZMUnHXdD41K9qx1P_gE2Y-qZlTv
  gKauwY7hUihoC6hJl7Vlic9ssX_fjZ6QGo0AzB3o5aHN_xgqSQUwAPpRmckfMnWPn2
  uZgD3Ei0AAAAdIW0OjVpeHzjoE7lStFvpGW3VnrUfloX5G24SUtysY6yWWtkvbtKj6
  fausG99w6GKAAAAAIFgnhW_xwhkRSVwwgEyNSyQ5PmrsAJnl6zkD88Uv_YBFVs0cLR
  sWpF1-uxU_QBw2aHYxR5B_wau84Q-oYB_8VcgmnxryMW0mWecdbeAwSovPsi1dPglp
  MmpOWX4t-8tbTM5DprN-iUtMcqtX876eq8AAAABF3EHyaXaecu5C5WxIjUr6pTFU4T
  4NN6B1xHEatCejiCLROs2UE_9icGHk2EViQpA-pIkshllp9sjA_DOfmav8xbHp8gnR
  gDblpmY84qOgG111UdIIMuTBkFK8sg16epbDiukjOuKL4WJV2c9dAaN7SHc0ZgavPV
  g8Q_pSqdFl4u"
}
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-bbs-present-jwp" class="selfRef">bbs-present-jwp</a>
            </figcaption></figure>
<p id="section-6.2.9-26">The same JWP in compact serialization:<a href="#section-6.2.9-26" class="pilcrow">¶</a></p>
<span id="name-bbs-present-compact"></span><figure id="figure-11">
            <div class="lang-text sourcecode" id="section-6.2.9-27.1">
<pre>ImV5SnBjM01pT2lKb2RIUndjem92TDJsemMzVmxjaTVsZUdGdGNHeGxJaXdpWTJ4aGFX
MXpJanBiSW1aaGJXbHNlVjl1WVcxbElpd2laMmwyWlc1ZmJtRnRaU0lzSW1WdFlXbHNJ
aXdpWVdkbElsMHNJblI1Y0NJNklrcFFWQ0lzSW1Gc1p5STZJa0pDVXkxWUluMCI.~Ikp
heSI~~NDI.AAUVqUnyMW_qGrrCzK7xHqUydeyQX5O6276HzUKz41aX9q7qzC6r-eHGh1
GD4Y3ZL9l_sA9ibulK3OYbyXVy0ym3LEC5LYyZMUnHXdD41K9qx1P_gE2Y-qZlTvgKau
wY7hUihoC6hJl7Vlic9ssX_fjZ6QGo0AzB3o5aHN_xgqSQUwAPpRmckfMnWPn2uZgD3E
i0AAAAdIW0OjVpeHzjoE7lStFvpGW3VnrUfloX5G24SUtysY6yWWtkvbtKj6fausG99w
6GKAAAAAIFgnhW_xwhkRSVwwgEyNSyQ5PmrsAJnl6zkD88Uv_YBFVs0cLRsWpF1-uxU_
QBw2aHYxR5B_wau84Q-oYB_8VcgmnxryMW0mWecdbeAwSovPsi1dPglpMmpOWX4t-8tb
TM5DprN-iUtMcqtX876eq8AAAABF3EHyaXaecu5C5WxIjUr6pTFU4T4NN6B1xHEatCej
iCLROs2UE_9icGHk2EViQpA-pIkshllp9sjA_DOfmav8xbHp8gnRgDblpmY84qOgG111
UdIIMuTBkFK8sg16epbDiukjOuKL4WJV2c9dAaN7SHc0ZgavPVg8Q_pSqdFl4u
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-bbs-present-compact" class="selfRef">bbs-present-compact</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="message-authentication-code">
<section id="section-6.3">
        <h3 id="name-message-authentication-code">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-message-authentication-code" class="section-name selfRef">Message Authentication Code</a>
        </h3>
<p id="section-6.3-1">The Message Authentication Code (MAC) JPA uses a MAC to both generate ephemeral keys and compute authentication codes to protect the issuer header and each payload individually.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Like the JWS-based JPA, it also does not support unlinkability if the same JWP is presented multiple times and requires an individually issued JWP for each presentation in order to fully protect privacy.  When compared to the JWS approach, using a MAC requires less computation but can result in potentially larger presentation proof values.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">The design is intentionally minimal and only involves using a single standardized MAC method instead of a mix of MAC/hash methods or a custom hash-based construct.  It is able to use any published cryptographic MAC method such as HMAC <span>[<a href="#RFC2104" class="cite xref">RFC2104</a>]</span> or <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf">KMAC</a>.  It uses traditional public-key based signatures to verify the authenticity of the issuer and holder.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<div id="holder-setup-1">
<section id="section-6.3.1">
          <h4 id="name-holder-setup-2">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-holder-setup-2" class="section-name selfRef">Holder Setup</a>
          </h4>
<p id="section-6.3.1-1">Prior to the issuer creating a new JWP it must have presentation binding information provided by the holder.  This enables the holder to perform replay prevention while presenting the JWP.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2">The presentation key used by the holder must be transferred to the issuer and verified, likely through a challenge and self-signing mechanism.  If the holder requires unlinkability it must also generate a new key that is verified and bound to each new JWP.<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<p id="section-6.3.1-3">How these holder presentation keys are transferred and verified is out of scope of this specification, protocols such as OpenID Connect can be used to accomplish this.  What is required by this definition is that the holder's presentation key MUST be included in the issuer's protected header using the <code>pjwk</code> claim with a JWK as the value.<a href="#section-6.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-setup-1">
<section id="section-6.3.2">
          <h4 id="name-issuer-setup-2">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-issuer-setup-2" class="section-name selfRef">Issuer Setup</a>
          </h4>
<p id="section-6.3.2-1">To use the MAC algorithm the issuer must have a stable public key pair to perform signing.  To start the issuance process, a single 32-byte random Shared Secret must first be generated.  This value will be shared privately to the holder as part of the issuer's JWP proof value.<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.3.2-2">The Shared Secret is used by both the issuer and holder as the MAC method's key to generate a new set of unique ephemeral keys.  These keys are then used as the input to generate a MAC that protects each payload.<a href="#section-6.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-protected-header-2">
<section id="section-6.3.3">
          <h4 id="name-issuer-protected-header-3">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-issuer-protected-header-3" class="section-name selfRef">Issuer Protected Header</a>
          </h4>
<p id="section-6.3.3-1">The holder's presentation key JWK MUST be included in the issuer protected header using the <code>pjwk</code> claim.  The issuer MUST validate that the holder has possession of this key through a trusted mechanism such as verifying the signature of a unique nonce value from the holder.<a href="#section-6.3.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3.3-2">For consistency, the issuer header is also protected by a MAC by using the fixed value "issuer_header" as the input key.  The issuer header JSON is serialized using UTF-8 and encoded with base64url into an octet array.  The final issuer header MAC is generated from the octet array and the fixed key, and the resulting value becomes the first input into the larger octet array that will be signed by the issuer.<a href="#section-6.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payloads-2">
<section id="section-6.3.4">
          <h4 id="name-payloads-3">
<a href="#section-6.3.4" class="section-number selfRef">6.3.4. </a><a href="#name-payloads-3" class="section-name selfRef">Payloads</a>
          </h4>
<p id="section-6.3.4-1">A unique key is generated for each payload using the MAC with the Shared Secret as the key and the values "payload<em>X" where "X" is replaced by the zero-based array index of the payload, for example "payload</em>0", "payload_1", etc.<a href="#section-6.3.4-1" class="pilcrow">¶</a></p>
<p id="section-6.3.4-2">Each payload is serialized using UTF-8 and encoded with base64url into an octet array.  The generated key for that payload based on its index is used to generate the MAC for the payload's encoded octet array.  The resulting value is appended to the larger octet array that will be signed by the issuer.<a href="#section-6.3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-proof">
<section id="section-6.3.5">
          <h4 id="name-issuer-proof">
<a href="#section-6.3.5" class="section-number selfRef">6.3.5. </a><a href="#name-issuer-proof" class="section-name selfRef">Issuer Proof</a>
          </h4>
<p id="section-6.3.5-1">The issuer proof consists of two items appended together, the issuer's signature of the appended array of MACs, and the Shared Secret used to generate the set of payload keys.<a href="#section-6.3.5-1" class="pilcrow">¶</a></p>
<p id="section-6.3.5-2">To generate the signature, the array containing the final MAC of the issuer protected header followed by all of the payload MACs appended in order is used as the input to a new JWS.<a href="#section-6.3.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.5-3">
<pre>jws_payload = [issuer_header_mac, payload_mac_1, ... payload_mac_n]
</pre><a href="#section-6.3.5-3" class="pilcrow">¶</a>
</div>
<p id="section-6.3.5-4">The issuer signs the JWS using its stable public key and a fixed header containing the <code>alg</code> associated with MAC algorithm in use.<a href="#section-6.3.5-4" class="pilcrow">¶</a></p>
<p id="section-6.3.5-5"><code>jws_header = '{"alg":"ES256"}'</code><a href="#section-6.3.5-5" class="pilcrow">¶</a></p>
<p id="section-6.3.5-6">The resulting signature is decoded and used as the first item in the issuer proof value.  The octet array of the Shared Secret is appended, resulting in the final issuer proof value.<a href="#section-6.3.5-6" class="pilcrow">¶</a></p>
<p id="section-6.3.5-7"><code>issuer_proof = [jws_signature, shared_secret]</code><a href="#section-6.3.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-protected-header-1">
<section id="section-6.3.6">
          <h4 id="name-presentation-protected-heade">
<a href="#section-6.3.6" class="section-number selfRef">6.3.6. </a><a href="#name-presentation-protected-heade" class="section-name selfRef">Presentation Protected Header</a>
          </h4>
<p id="section-6.3.6-1">See the JWS <a href="#presentation-protected-header">Presentation Protected Header</a> section.<a href="#section-6.3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-2">
<section id="section-6.3.7">
          <h4 id="name-presentation-3">
<a href="#section-6.3.7" class="section-number selfRef">6.3.7. </a><a href="#name-presentation-3" class="section-name selfRef">Presentation</a>
          </h4>
<blockquote id="section-6.3.7-1">
            <p id="section-6.3.7-1.1">Editor's Note: The current definition here is incomplete, the holder's signature needs to also incorporate the presented proof.<a href="#section-6.3.7-1.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-6.3.7-2">The presentation proof is constructed as a large octet array containing multiple appended items similar to the issuer proof value.  The first item is the JWS decoded signature value generated when the holder uses the presentation key to sign the presentation header.  The second item is the issuer signature from the issuer's proof value.<a href="#section-6.3.7-2" class="pilcrow">¶</a></p>
<p id="section-6.3.7-3">These two signatures are then followed by a MAC value for each payload.  The MAC values used will depend on if that payload has been disclosed or is hidden.  Disclosed payloads will include the MAC key input, and hidden payloads will include only their final MAC value.<a href="#section-6.3.7-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3.7-4">
<pre>presentation_proof = [presentation_signature, issuer_signature,
                      disclosed_key_0, hidden_mac_1, hidden_mac_2,
                      ... disclosed_key_n]
</pre><a href="#section-6.3.7-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3.7-5">The size of this value will depend on the underlying cryptographic algorithms.  For example, <code>MAC-H256</code> uses the <code>ES256</code> JWS with a decoded signature of 64 octets, and for a JWP with five payloads using <code>HMAC-SHA256</code> the total presentation proof value length would be <code>64 + 64 + (5 * 32) = 288</code> octets.<a href="#section-6.3.7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifier-setup">
<section id="section-6.3.8">
          <h4 id="name-verifier-setup">
<a href="#section-6.3.8" class="section-number selfRef">6.3.8. </a><a href="#name-verifier-setup" class="section-name selfRef">Verifier Setup</a>
          </h4>
<p id="section-6.3.8-1">In order to verify that the presentation was protected from replay attacks, the verifier must be able to validate the presentation protected header.  This involves the following steps:<a href="#section-6.3.8-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3.8-2">
<li id="section-6.3.8-2.1">JSON parse the presentation header<a href="#section-6.3.8-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-2.2">Validate the contained <code>nonce</code> claim<a href="#section-6.3.8-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-2.3">JSON parse the issuer header<a href="#section-6.3.8-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-2.4">Validate the contained <code>pjwk</code> claim<a href="#section-6.3.8-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-2.5">Create a JWS using the correct fixed header with <code>alg</code> value and the presentation header as the body<a href="#section-6.3.8-2.5" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-2.6">Remove the <code>presentation_signature</code> from the beginning of the <code>presentation_proof</code> octet array<a href="#section-6.3.8-2.6" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-2.7">Validate the JWS using the JWK from the <code>pjwk</code> claim and the <code>presentation_signature</code> value<a href="#section-6.3.8-2.7" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-6.3.8-3">Next, the verifier must validate all of the disclosed payloads using the following steps:<a href="#section-6.3.8-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3.8-4">
<li id="section-6.3.8-4.1">JSON parse the issuer header<a href="#section-6.3.8-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-4.2">Resolve the <code>kid</code> using a trusted mechanism to obtain the correct issuer JWK<a href="#section-6.3.8-4.2" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-4.3">Remove the <code>issuer_signature</code> from the beginning of the remaining <code>presentation_proof</code> octet array (after the <code>presentation_signature</code> was removed)<a href="#section-6.3.8-4.3" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-4.4">Perform the MAC on the presented <code>issuer_header</code> value using the "issuer_header" value as the input key<a href="#section-6.3.8-4.4" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-4.5">Store the resulting value as the first entry in a new <code>jws_payload</code> octet array<a href="#section-6.3.8-4.5" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-4.6">
              <p id="section-6.3.8-4.6.1">Iterate on each presented payload (disclosed or hidden)<a href="#section-6.3.8-4.6.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3.8-4.6.2">
<li id="section-6.3.8-4.6.2.1">Extract the next hash value from the remaining <code>presentation_proof</code> octet array<a href="#section-6.3.8-4.6.2.1" class="pilcrow">¶</a>
</li>
                <li id="section-6.3.8-4.6.2.2">If the payload was disclosed: perform a MAC using the given hash value as the input key and append the result to the <code>jws_payload</code> octet array<a href="#section-6.3.8-4.6.2.2" class="pilcrow">¶</a>
</li>
                <li id="section-6.3.8-4.6.2.3">If the payload was hidden: append the given hash value to the <code>jws_payload</code> octet array<a href="#section-6.3.8-4.6.2.3" class="pilcrow">¶</a>
</li>
              </ol>
</li>
            <li id="section-6.3.8-4.7">Create a JWS using a header containing the <code>alg</code> parameter along with the generated <code>jws_payload</code> value as the payload<a href="#section-6.3.8-4.7" class="pilcrow">¶</a>
</li>
            <li id="section-6.3.8-4.8">Validate the JWS using the resolved issuer JWK and the extracted <code>issuer_signature</code> value<a href="#section-6.3.8-4.8" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="jpa-registration-2">
<section id="section-6.3.9">
          <h4 id="name-jpa-registration-3">
<a href="#section-6.3.9" class="section-number selfRef">6.3.9. </a><a href="#name-jpa-registration-3" class="section-name selfRef">JPA Registration</a>
          </h4>
<p id="section-6.3.9-1">Proposed JWP <code>alg</code> value is of the format "MAC-" appended with a unique identifier for the set of MAC and signing algorithms used.  Below are the initial registrations:<a href="#section-6.3.9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.9-2.1">
              <code>MAC-H256</code> uses <code>HMAC SHA-256</code> as the MAC and <code>ECDSA using P-256 and SHA-256</code> for the signatures<a href="#section-6.3.9-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.9-2.2">
              <code>MAC-H384</code> uses <code>HMAC SHA-384</code> as the MAC and <code>ECDSA using P-384 and SHA-384</code> for the signatures<a href="#section-6.3.9-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.9-2.3">
              <code>MAC-H512</code> uses <code>HMAC SHA-512</code> as the MAC and <code>ECDSA using P-521 and SHA-512</code> for the signatures<a href="#section-6.3.9-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.9-2.4">
              <code>MAC-K25519</code> uses <code>KMAC SHAKE128</code> as the MAC and <code>EdDSA using Curve25519</code> for the signatures<a href="#section-6.3.9-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.9-2.5">
              <code>MAC-K448</code> uses <code>KMAC SHAKE256</code> as the MAC and <code>EdDSA using Curve448</code> for the signatures<a href="#section-6.3.9-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.9-2.6">
              <code>MAC-H256K</code> uses <code>HMAC SHA-256</code> as the MAC and <code>ECDSA using secp256k1 and SHA-256</code> for the signatures<a href="#section-6.3.9-2.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="example-2">
<section id="section-6.3.10">
          <h4 id="name-example-3">
<a href="#section-6.3.10" class="section-number selfRef">6.3.10. </a><a href="#name-example-3" class="section-name selfRef">Example</a>
          </h4>
<p id="section-6.3.10-1">The following example uses the <code>MAC-H256</code> algorithm.<a href="#section-6.3.10-1" class="pilcrow">¶</a></p>
<p id="section-6.3.10-2">This is the Signer's stable private key in the JWK format:<a href="#section-6.3.10-2" class="pilcrow">¶</a></p>
<span id="name-issuer-private-jwk"></span><figure id="figure-12">
            <div class="lang-json sourcecode" id="section-6.3.10-3.1">
<pre>{
  "crv": "P-256",
  "kty": "EC",
  "x": "ONebN43-G5DOwZX6jCVpEYEe0bYd5WDybXAG0sL3iDA",
  "y": "b0MHuYfSxu3Pj4DAyDXabAc0mPjpB1worEpr3yyrft4",
  "d": "jnE0-9YvxQtLJEKcyUHU6HQ3Y9nSDnh0NstYJFn7RuI"
}
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-issuer-private-jwk" class="selfRef">issuer-private-jwk</a>
            </figcaption></figure>
<p id="section-6.3.10-4">This is the Signer's generated Shared Secret:<a href="#section-6.3.10-4" class="pilcrow">¶</a></p>
<span id="name-mac-shared-secret"></span><figure id="figure-13">
            <div class="lang-json sourcecode" id="section-6.3.10-5.1">
<pre>[100, 109, 91, 184, 139, 20, 107, 86, 1, 252, 86, 159, 126, 251,
228, 4, 35, 177, 75, 96, 11, 205, 144, 189, 42, 95, 135, 170, 107,
58, 99, 142]
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-mac-shared-secret" class="selfRef">mac-shared-secret</a>
            </figcaption></figure>
<p id="section-6.3.10-6">This is the Holder's presentation private key in the JWK format:<a href="#section-6.3.10-6" class="pilcrow">¶</a></p>
<span id="name-holder-presentation-jwk"></span><figure id="figure-14">
            <div class="lang-json sourcecode" id="section-6.3.10-7.1">
<pre>{
  "crv": "P-256",
  "kty": "EC",
  "x": "oB1TPrE_QJIL61fUOOK5DpKgd8j2zbZJtqpILDTJX6I",
  "y": "3JqnrkucLobkdRuOqZXOP9MMlbFyenFOLyGlG-FPACM",
  "d": "AvyDPl1I4xwjrI2iEOi6DxM9ipJe_h_VUN5OvoKvvW8"
}
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-holder-presentation-jwk" class="selfRef">holder-presentation-jwk</a>
            </figcaption></figure>
<p id="section-6.3.10-8">The first MAC is generated using the key <code>issuer_header</code> and the base64url-encoded issuer protected header, resulting in this octet array:<a href="#section-6.3.10-8" class="pilcrow">¶</a></p>
<span id="name-mac-issuer-header-mac"></span><figure id="figure-15">
            <div class="lang-json sourcecode" id="section-6.3.10-9.1">
<pre>[140, 88, 59, 30, 127, 113, 27, 237, 78, 200, 182, 114, 94, 123,
198, 128, 102, 232, 178, 88, 252, 248, 57, 2, 231, 19, 145, 8, 160,
197, 66, 166]
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-mac-issuer-header-mac" class="selfRef">mac-issuer-header-mac</a>
            </figcaption></figure>
<p id="section-6.3.10-10">The issuer generates an array of derived keys with one for each payload by using the shared secret as the key and the index of the payload as the input:<a href="#section-6.3.10-10" class="pilcrow">¶</a></p>
<span id="name-mac-issuer-keys"></span><figure id="figure-16">
            <div class="lang-json sourcecode" id="section-6.3.10-11.1">
<pre>[
 [180, 129, 55, 94, 125, 158, 179, 245, 30, 199, 148, 60, 184, 28,
 197, 123, 231, 232, 95, 91, 65, 74, 38, 242, 253, 96, 67, 44, 40,
 220, 250, 4],
 [143, 172, 182, 156, 184, 138, 228, 172, 215, 26, 175, 137, 137,
 25, 159, 141, 213, 12, 214, 29, 231, 200, 13, 94, 116, 22, 41, 115,
 72, 214, 57, 98],
 [144, 73, 77, 66, 230, 187, 217, 186, 246, 41, 138, 25, 39, 203,
 101, 76, 156, 161, 244, 130, 203, 166, 184, 154, 7, 4, 218, 84,
 168, 199, 36, 245],
 [70, 55, 182, 105, 101, 130, 254, 234, 68, 224, 219, 97, 119, 98,
 244, 33, 43, 55, 148, 238, 225, 177, 101, 160, 49, 246, 109, 155,
 242, 236, 21, 138]
]
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-mac-issuer-keys" class="selfRef">mac-issuer-keys</a>
            </figcaption></figure>
<p id="section-6.3.10-12">The first payload is the string <code>"Doe"</code> with the octet sequence of <code>[ 34, 68, 111, 101, 34 ]</code> and base64url-encoded as <code>IkRvZSI</code>.<a href="#section-6.3.10-12" class="pilcrow">¶</a></p>
<p id="section-6.3.10-13">The second payload is the string <code>"Jay"</code> with the octet sequence of <code>[ 34, 74, 97, 121, 34 ]</code> and base64url-encoded as <code>IkpheSI</code>.<a href="#section-6.3.10-13" class="pilcrow">¶</a></p>
<p id="section-6.3.10-14">The third payload is the string <code>"jaydoe@example.org"</code> with the octet sequence of <code>[ 34, 106, 97, 121, 100, 111, 101, 64, 101, 120, 97, 109, 112, 108, 101, 46, 111, 114, 103, 34 ]</code> and base64url-encoded as <code>ImpheWRvZUBleGFtcGxlLm9yZyI</code>.<a href="#section-6.3.10-14" class="pilcrow">¶</a></p>
<p id="section-6.3.10-15">The fourth payload is the string <code>42</code> with the octet sequence of <code>[ 52, 50 ]</code> and base64url-encoded as <code>NDI</code>.<a href="#section-6.3.10-15" class="pilcrow">¶</a></p>
<p id="section-6.3.10-16">A MAC is generated for each payload using the generated key for its given index, resulting in an array of MACs:<a href="#section-6.3.10-16" class="pilcrow">¶</a></p>
<span id="name-mac-issuer-macs"></span><figure id="figure-17">
            <div class="lang-json sourcecode" id="section-6.3.10-17.1">
<pre>[
 [156, 53, 90, 125, 139, 226, 60, 168, 100, 220, 79, 255, 8, 87, 28,
 220, 237, 112, 161, 91, 39, 68, 137, 203, 92, 243, 16, 116, 64,
 129, 61, 172],
 [239, 17, 12, 35, 111, 129, 51, 87, 43, 86, 234, 38, 89, 149, 169,
 157, 33, 104, 81, 246, 190, 154, 74, 195, 194, 158, 50, 208, 203,
 203, 249, 237],
 [162, 174, 12, 27, 190, 250, 112, 1, 139, 177, 49, 124, 110, 201,
 83, 233, 14, 109, 60, 253, 121, 184, 126, 121, 26, 138, 5, 214, 97,
 96, 216, 80],
 [61, 109, 78, 172, 255, 189, 67, 83, 247, 65, 234, 128, 30, 47,
 145, 70, 129, 26, 41, 41, 78, 4, 151, 230, 232, 127, 135, 230, 14,
 208, 178, 50]
]
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-mac-issuer-macs" class="selfRef">mac-issuer-macs</a>
            </figcaption></figure>
<p id="section-6.3.10-18">Concatenating the issuer protected header MAC with the array of payload MACs produces a single octet array that is signed using the issuer's stable key, resulting in the following signature:<a href="#section-6.3.10-18" class="pilcrow">¶</a></p>
<span id="name-mac-issuer-signature"></span><figure id="figure-18">
            <div class="lang-json sourcecode" id="section-6.3.10-19.1">
<pre>[120, 172, 15, 230, 138, 230, 150, 139, 241, 196, 79, 134, 122, 43,
149, 11, 253, 104, 58, 199, 49, 87, 32, 64, 237, 50, 86, 155, 153,
58, 63, 116, 245, 130, 136, 197, 164, 207, 232, 238, 106, 171, 246,
98, 149, 254, 22, 1, 114, 187, 233, 168, 116, 173, 211, 208, 234,
245, 76, 238, 143, 157, 83, 202]
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-mac-issuer-signature" class="selfRef">mac-issuer-signature</a>
            </figcaption></figure>
<p id="section-6.3.10-20">The original shared secret octet string is then concatenated to the end of the issuer signature octet string and the result is base64url-encoded as the issuer's proof value.<a href="#section-6.3.10-20" class="pilcrow">¶</a></p>
<p id="section-6.3.10-21">The final issued JWP in JSON serialization is:<a href="#section-6.3.10-21" class="pilcrow">¶</a></p>
<span id="name-mac-issued-jwp"></span><figure id="figure-19">
            <div class="lang-json sourcecode" id="section-6.3.10-22.1">
<pre>{
  "payloads": [
    "IkRvZSI",
    "IkpheSI",
    "ImpheWRvZUBleGFtcGxlLm9yZyI",
    "NDI"
  ],
  "issuer": "eyJpc3MiOiJodHRwczovL2lzc3Vlci50bGQiLCJjbGFpbXMiOlsiZmF
  taWx5X25hbWUiLCJnaXZlbl9uYW1lIiwiZW1haWwiLCJhZ2UiXSwidHlwIjoiSlBUI
  iwicGp3ayI6eyJjcnYiOiJQLTI1NiIsImt0eSI6IkVDIiwieCI6Im9CMVRQckVfUUp
  JTDYxZlVPT0s1RHBLZ2Q4ajJ6YlpKdHFwSUxEVEpYNkkiLCJ5IjoiM0pxbnJrdWNMb
  2JrZFJ1T3FaWE9QOU1NbGJGeWVuRk9MeUdsRy1GUEFDTSJ9LCJhbGciOiJNQUMtSDI
  1NiJ9",
  "proof": "eKwP5ormlovxxE-GeiuVC_1oOscxVyBA7TJWm5k6P3T1gojFpM_o7mqr
  9mKV_hYBcrvpqHSt09Dq9Uzuj51TymRtW7iLFGtWAfxWn3775AQjsUtgC82QvSpfh6
  prOmOO"
}
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-mac-issued-jwp" class="selfRef">mac-issued-jwp</a>
            </figcaption></figure>
<p id="section-6.3.10-23">The same JWP in compact serialization:<a href="#section-6.3.10-23" class="pilcrow">¶</a></p>
<span id="name-mac-issued-compact"></span><figure id="figure-20">
            <div class="lang-text sourcecode" id="section-6.3.10-24.1">
<pre>eyJpc3MiOiJodHRwczovL2lzc3Vlci50bGQiLCJjbGFpbXMiOlsiZmFtaWx5X25hbWUi
LCJnaXZlbl9uYW1lIiwiZW1haWwiLCJhZ2UiXSwidHlwIjoiSlBUIiwicGp3ayI6eyJj
cnYiOiJQLTI1NiIsImt0eSI6IkVDIiwieCI6Im9CMVRQckVfUUpJTDYxZlVPT0s1RHBL
Z2Q4ajJ6YlpKdHFwSUxEVEpYNkkiLCJ5IjoiM0pxbnJrdWNMb2JrZFJ1T3FaWE9QOU1N
bGJGeWVuRk9MeUdsRy1GUEFDTSJ9LCJhbGciOiJNQUMtSDI1NiJ9.IkRvZSI~IkpheSI
~ImpheWRvZUBleGFtcGxlLm9yZyI~NDI.eKwP5ormlovxxE-GeiuVC_1oOscxVyBA7TJ
Wm5k6P3T1gojFpM_o7mqr9mKV_hYBcrvpqHSt09Dq9Uzuj51TymRtW7iLFGtWAfxWn37
75AQjsUtgC82QvSpfh6prOmOO
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-mac-issued-compact" class="selfRef">mac-issued-compact</a>
            </figcaption></figure>
<p id="section-6.3.10-25">Next, we show the presentation of the JWP with selective disclosure.<a href="#section-6.3.10-25" class="pilcrow">¶</a></p>
<p id="section-6.3.10-26">We start with this presentation header using a nonce provided by the Verifier:<a href="#section-6.3.10-26" class="pilcrow">¶</a></p>
<span id="name-mac-presentation-header"></span><figure id="figure-21">
            <div class="lang-json sourcecode" id="section-6.3.10-27.1">
<pre>{
  "nonce": "uTEB371l1pzWJl7afB0wi0HWUNk1Le-bComFLxa8K-s"
}
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-mac-presentation-header" class="selfRef">mac-presentation-header</a>
            </figcaption></figure>
<p id="section-6.3.10-28">When signed with the holder's presentation key, the resulting signature octets are:<a href="#section-6.3.10-28" class="pilcrow">¶</a></p>
<span id="name-mac-presentation-header-sig"></span><figure id="figure-22">
            <div class="lang-json sourcecode" id="section-6.3.10-29.1">
<pre>[126, 134, 175, 2, 165, 12, 103, 11, 116, 72, 94, 228, 240, 142,
107, 195, 198, 238, 218, 203, 63, 198, 105, 175, 1, 69, 182, 5, 204,
239, 35, 149, 85, 55, 4, 169, 109, 243, 88, 213, 12, 1, 167, 235,
222, 17, 232, 118, 110, 111, 47, 165, 102, 142, 0, 1, 226, 117, 143,
125, 132, 62, 231, 145]
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-mac-presentation-header-sig" class="selfRef">mac-presentation-header-signature</a>
            </figcaption></figure>
<p id="section-6.3.10-30">Then by applying selective disclosure of only the given name and age claims (family name and email hidden, payload array indexes 0 and 2), the holder builds a mixed array of either the payload key (if disclosed) or MAC (if hidden):<a href="#section-6.3.10-30" class="pilcrow">¶</a></p>
<span id="name-mac-presentation-keyormac"></span><figure id="figure-23">
            <div class="lang-json sourcecode" id="section-6.3.10-31.1">
<pre>[
 [156, 53, 90, 125, 139, 226, 60, 168, 100, 220, 79, 255, 8, 87, 28,
 220, 237, 112, 161, 91, 39, 68, 137, 203, 92, 243, 16, 116, 64,
 129, 61, 172],
 [143, 172, 182, 156, 184, 138, 228, 172, 215, 26, 175, 137, 137,
 25, 159, 141, 213, 12, 214, 29, 231, 200, 13, 94, 116, 22, 41, 115,
 72, 214, 57, 98],
 [162, 174, 12, 27, 190, 250, 112, 1, 139, 177, 49, 124, 110, 201,
 83, 233, 14, 109, 60, 253, 121, 184, 126, 121, 26, 138, 5, 214, 97,
 96, 216, 80],
 [70, 55, 182, 105, 101, 130, 254, 234, 68, 224, 219, 97, 119, 98,
 244, 33, 43, 55, 148, 238, 225, 177, 101, 160, 49, 246, 109, 155,
 242, 236, 21, 138]
]
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-mac-presentation-keyormac" class="selfRef">mac-presentation-keyormac</a>
            </figcaption></figure>
<p id="section-6.3.10-32">The final presented proof value is generated by concatenating first the presentation header signature octet string, followed by the issuer signature octet string, then followed by the mixed array of keys and MACs:<a href="#section-6.3.10-32" class="pilcrow">¶</a></p>
<span id="name-mac-presentation-proof"></span><figure id="figure-24">
            <div class="lang-json sourcecode" id="section-6.3.10-33.1">
<pre>[126, 134, 175, 2, 165, 12, 103, 11, 116, 72, 94, 228, 240, 142,
107, 195, 198, 238, 218, 203, 63, 198, 105, 175, 1, 69, 182, 5, 204,
239, 35, 149, 85, 55, 4, 169, 109, 243, 88, 213, 12, 1, 167, 235,
222, 17, 232, 118, 110, 111, 47, 165, 102, 142, 0, 1, 226, 117, 143,
125, 132, 62, 231, 145, 120, 172, 15, 230, 138, 230, 150, 139, 241,
196, 79, 134, 122, 43, 149, 11, 253, 104, 58, 199, 49, 87, 32, 64,
237, 50, 86, 155, 153, 58, 63, 116, 245, 130, 136, 197, 164, 207,
232, 238, 106, 171, 246, 98, 149, 254, 22, 1, 114, 187, 233, 168,
116, 173, 211, 208, 234, 245, 76, 238, 143, 157, 83, 202, 156, 53,
90, 125, 139, 226, 60, 168, 100, 220, 79, 255, 8, 87, 28, 220, 237,
112, 161, 91, 39, 68, 137, 203, 92, 243, 16, 116, 64, 129, 61, 172,
143, 172, 182, 156, 184, 138, 228, 172, 215, 26, 175, 137, 137, 25,
159, 141, 213, 12, 214, 29, 231, 200, 13, 94, 116, 22, 41, 115, 72,
214, 57, 98, 162, 174, 12, 27, 190, 250, 112, 1, 139, 177, 49, 124,
110, 201, 83, 233, 14, 109, 60, 253, 121, 184, 126, 121, 26, 138, 5,
214, 97, 96, 216, 80, 70, 55, 182, 105, 101, 130, 254, 234, 68, 224,
219, 97, 119, 98, 244, 33, 43, 55, 148, 238, 225, 177, 101, 160, 49,
246, 109, 155, 242, 236, 21, 138]
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-mac-presentation-proof" class="selfRef">mac-presentation-proof</a>
            </figcaption></figure>
<p id="section-6.3.10-34">The resulting presented JWP in JSON serialization is:<a href="#section-6.3.10-34" class="pilcrow">¶</a></p>
<span id="name-mac-presentation-jwp"></span><figure id="figure-25">
            <div class="lang-json sourcecode" id="section-6.3.10-35.1">
<pre>{
  "payloads": [
    null,
    "IkpheSI",
    null,
    "NDI"
  ],
  "issuer": "eyJpc3MiOiJodHRwczovL2lzc3Vlci50bGQiLCJjbGFpbXMiOlsiZmF
  taWx5X25hbWUiLCJnaXZlbl9uYW1lIiwiZW1haWwiLCJhZ2UiXSwidHlwIjoiSlBUI
  iwicGp3ayI6eyJjcnYiOiJQLTI1NiIsImt0eSI6IkVDIiwieCI6Im9CMVRQckVfUUp
  JTDYxZlVPT0s1RHBLZ2Q4ajJ6YlpKdHFwSUxEVEpYNkkiLCJ5IjoiM0pxbnJrdWNMb
  2JrZFJ1T3FaWE9QOU1NbGJGeWVuRk9MeUdsRy1GUEFDTSJ9LCJhbGciOiJNQUMtSDI
  1NiJ9",
  "proof": "foavAqUMZwt0SF7k8I5rw8bu2ss_xmmvAUW2BczvI5VVNwSpbfNY1QwB
  p-veEeh2bm8vpWaOAAHidY99hD7nkXisD-aK5paL8cRPhnorlQv9aDrHMVcgQO0yVp
  uZOj909YKIxaTP6O5qq_Zilf4WAXK76ah0rdPQ6vVM7o-dU8qcNVp9i-I8qGTcT_8I
  Vxzc7XChWydEictc8xB0QIE9rI-stpy4iuSs1xqviYkZn43VDNYd58gNXnQWKXNI1j
  lioq4MG776cAGLsTF8bslT6Q5tPP15uH55GooF1mFg2FBGN7ZpZYL-6kTg22F3YvQh
  KzeU7uGxZaAx9m2b8uwVig",
  "presentation": "eyJub25jZSI6InVURUIzNzFsMXB6V0psN2FmQjB3aTBIV1VOa
  zFMZS1iQ29tRkx4YThLLXMifQ"
}
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-mac-presentation-jwp" class="selfRef">mac-presentation-jwp</a>
            </figcaption></figure>
<p id="section-6.3.10-36">The same JWP in compact serialization:<a href="#section-6.3.10-36" class="pilcrow">¶</a></p>
<span id="name-mac-presentation-compact"></span><figure id="figure-26">
            <div class="lang-text sourcecode" id="section-6.3.10-37.1">
<pre>eyJpc3MiOiJodHRwczovL2lzc3Vlci50bGQiLCJjbGFpbXMiOlsiZmFtaWx5X25hbWUi
LCJnaXZlbl9uYW1lIiwiZW1haWwiLCJhZ2UiXSwidHlwIjoiSlBUIiwicGp3ayI6eyJj
cnYiOiJQLTI1NiIsImt0eSI6IkVDIiwieCI6Im9CMVRQckVfUUpJTDYxZlVPT0s1RHBL
Z2Q4ajJ6YlpKdHFwSUxEVEpYNkkiLCJ5IjoiM0pxbnJrdWNMb2JrZFJ1T3FaWE9QOU1N
bGJGeWVuRk9MeUdsRy1GUEFDTSJ9LCJhbGciOiJNQUMtSDI1NiJ9.eyJub25jZSI6InV
URUIzNzFsMXB6V0psN2FmQjB3aTBIV1VOazFMZS1iQ29tRkx4YThLLXMifQ.~IkpheSI
~~NDI.foavAqUMZwt0SF7k8I5rw8bu2ss_xmmvAUW2BczvI5VVNwSpbfNY1QwBp-veEe
h2bm8vpWaOAAHidY99hD7nkXisD-aK5paL8cRPhnorlQv9aDrHMVcgQO0yVpuZOj909Y
KIxaTP6O5qq_Zilf4WAXK76ah0rdPQ6vVM7o-dU8qcNVp9i-I8qGTcT_8IVxzc7XChWy
dEictc8xB0QIE9rI-stpy4iuSs1xqviYkZn43VDNYd58gNXnQWKXNI1jlioq4MG776cA
GLsTF8bslT6Q5tPP15uH55GooF1mFg2FBGN7ZpZYL-6kTg22F3YvQhKzeU7uGxZaAx9m
2b8uwVig
</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-mac-presentation-compact" class="selfRef">mac-presentation-compact</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<blockquote id="section-7-1">
        <p id="section-7-1.1">Editor's Note: This will follow once the algorithms defined here have become more stable.<a href="#section-7-1.1" class="pilcrow">¶</a></p>
</blockquote>
<ul class="normal">
<li class="normal" id="section-7-2.1">Data minimization of the proof value<a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.2">Unlinkability of the protected header contents<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="jwp-algorithms-registry">
<section id="section-8.1">
        <h3 id="name-jwp-algorithms-registry">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-jwp-algorithms-registry" class="section-name selfRef">JWP Algorithms Registry</a>
        </h3>
<p id="section-8.1-1">This section establishes the IANA JWP Algorithms Registry.  It also registers the following algorithms.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">TBD<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-normative-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="I-D.ietf-jose-json-web-proof">[I-D.ietf-jose-json-web-proof]</dt>
      <dd>
<span class="refAuthor">Miller, J.</span>, <span class="refAuthor">Waite, D.</span>, and <span class="refAuthor">M. B. Jones</span>, <span class="refTitle">"JSON Web Proof"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-jose-json-web-proof-01</span>, <time datetime="2023-07-10" class="refDate">10 July 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-jose-json-web-proof-01">https://datatracker.ietf.org/doc/html/draft-ietf-jose-json-web-proof-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-bbs-signatures">[I-D.irtf-cfrg-bbs-signatures]</dt>
    <dd>
<span class="refAuthor">Looker, T.</span>, <span class="refAuthor">Kalos, V.</span>, <span class="refAuthor">Whitehead, A.</span>, and <span class="refAuthor">M. Lodder</span>, <span class="refTitle">"The BBS Signature Scheme"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-bbs-signatures-03</span>, <time datetime="2023-07-10" class="refDate">10 July 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bbs-signatures-03">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bbs-signatures-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10">
      <h2 id="name-informative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC2104">[RFC2104]</dt>
      <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">TBD<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-B">
      <h2 id="name-document-history">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-B-1">[[ To be removed from the final specification ]]<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">-00<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">Created initial working group draft based on draft-jmiller-jose-json-proof-algorithms-01<a href="#appendix-B-3.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeremie Miller</span></div>
<div dir="auto" class="left"><span class="org">Ping Identity</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jmiller@pingidentity.com" class="email">jmiller@pingidentity.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael B. Jones</span></div>
<div dir="auto" class="left"><span class="org">individual</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michael_b_jones@hotmail.com" class="email">michael_b_jones@hotmail.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://self-issued.info/" class="url">https://self-issued.info/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Waite</span></div>
<div dir="auto" class="left"><span class="org">Ping Identity</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dwaite+jwp@pingidentity.com" class="email">dwaite+jwp@pingidentity.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
